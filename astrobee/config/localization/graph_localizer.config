-- Copyright (c) 2017, United States Government, as represented by the
-- Administrator of the National Aeronautics and Space Administration.
--
-- All rights reserved.
--
-- The Astrobee platform is licensed under the Apache License, Version 2.0
-- (the "License"); you may not use this file except in compliance with the
-- License. You may obtain a copy of the License at
--
--     http://www.apache.org/licenses/LICENSE-2.0
--
-- Unless required by applicable law or agreed to in writing, software
-- distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
-- WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
-- License for the specific language governing permissions and limitations
-- under the License.
require "context"

-- Factor Adders (fa)
--- Loc 
fa_loc_enabled = true
fa_loc_huber_k = world_huber_k
fa_loc_add_pose_priors = false 
fa_loc_add_projection_factors = true
fa_loc_add_prior_if_projection_factors_fail = true 
fa_loc_prior_translation_stddev = 0.06 
fa_loc_prior_quaternion_stddev = 0.06
fa_loc_scale_pose_noise_with_num_landmarks = true 
fa_loc_scale_projection_noise_with_num_landmarks = false 
fa_loc_scale_projection_noise_with_landmark_distance = false 
fa_loc_pose_noise_scale = 7 
fa_loc_-- Change to 9 if scale with inverse distance
fa_loc_projection_noise_scale = 60
fa_loc_max_num_projection_factors = 50 
fa_loc_min_num_matches_per_measurement = 5 
// TODO: check this, same as error norm?
fa_loc_max_valid_projection_error = 30
fa_loc_nav_cam_noise_stddev = 0.1
-- Node Adders (na)
--- Pose
na_pose_starting_prior_translation_stddev = 
na_pose_starting_prior_quaternion_stddev = 
na_pose_huber_k = world_huber_k 
na_pose_add_priors = true 
// TODO: tune these!
na_pose_ideal_duration = 10 
na_pose_min_num_states = 3 
na_pose_max_num_states = 20
// TODO: start node??
na_pose_model_huber_k = world_huber_k
-- Optimizer (op)
--- Nonlinear
op_nl_marginals_factorization = "qr"
// TODO: tune this!
op_nl_max_iterations = 10 
op_nl_verbose = false 
op_nl_use_ceres_params = false 
-- Graph Optimizer (go)
--- Sliding Window 
go_sw_huber_k = world_huber_k 
go_sw_log_stats_on_destruction = false
go_sw_print_after_optimization = false
go_sw_add_marginal_factors = false 
go_sw_slide_window_before_optimization = true
-- Other
// TODO: tune this!
max_vio_measurement_gap = 3 

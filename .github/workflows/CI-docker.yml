name: Docker Image CI

on:
  push:
    branches: [ master, develop ]
  pull_request:
    branches: [ master, develop ]

jobs:

  build-and-test:

    runs-on: ubuntu-16.04

    steps:
    - uses: actions/checkout@v2

    - name: Build the Docker image for Ubuntu 16
      run: docker build . --file ./scripts/docker/rebuild_astrobee_kinetic.Dockerfile --tag astrobee:latest-kinetic

    - name: Start docker container
      run: docker run -it --rm --name astrobee \
                      --user="astrobee" \
                      --gpus all \
                    astrobee:latest-kinetic \
                  /astrobee_init.sh roslaunch astrobee sim.launch dds:=false

#  build:
#
#    runs-on: ubuntu-18.04
#
#    steps:
#    - uses: actions/checkout@v2
#
#    - name: Build the Docker image for Ubuntu 16
#      run: docker build . --file ./scripts/docker/rebuild_astrobee_melodic.Dockerfile --tag astrobee:latest-melodic
